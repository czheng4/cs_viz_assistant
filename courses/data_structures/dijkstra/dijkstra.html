<!DOCTYPE html>
<html>
<head>

  <title></title>
  <link rel="stylesheet" href="../../../style/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style type="text/css">
    input[type = "text"]{
      width: 100px;
    }

    td {
    
      text-align: center;
      padding: 5px 7px 5px 7px;
     /* background-color: pink;*/
    }

    

  </style>
</head>
<body>
   <div class = "grid-container">
    <div class = "header">Dijkstra</div>
    <div class = "control"> 

     
      <input type="text" id="node_t" placeholder="node id"> 
      <button type="button" id = "add_node">Add Node</button> 
      <button type="button" id = "remove_node">Remove Node</button> &emsp;&emsp;

      <input type="text" id="edge_t" placeholder="id1 id2 weight"> 
      <button type="button" id = "add_edge">Add Edge</button>
      <button type="button" id = "remove_edge">Remove Edge</button> 
      
      
      <div class = "line"></div>

      <input type="text" id="starting_node" placeholder="starting node"> 
      <button type="button" id = "run">Run</button> &emsp;&emsp;

      <input type="text" id="ending_node" placeholder="ending node"> 
      <button type="button" id = "get_path">Get Path</button> &emsp;&emsp;
      <input type="radio" id="undirected" name="graph_type" value = "undirect" checked> 
      <label for="graph_type">Undirected Graph</label> 
      <input type="radio" id="directed" name="graph_type" value = "direct">
      <label for="graph_type">Directed Graph</label>
      <div class = "line"></div>
      
      <div class = "animation-control">
        <button type="button" id = "step_back">Step Back</button>&emsp;
        <button type="button" id = "step_forward">Step Forward</button>&emsp;&emsp;
        step by step animation<input type="checkbox" id="step_by_step">&emsp;&emsp;
        animation speed&emsp;<input type="range" min="0" max="90" value="0" id="speed"> 
      </div>

      <div class = "elaboration">
        Elaboration: <span id = "elaboration_text" style="color:red"></span> 
        <table border = 1 style = "border-collapse: collapse; margin-top: 5px">
          <tr id = "node">
            <td>Node</td>
          </tr>

          <tr id = "distance">
            <td>Distance</td>
          </tr>

          <tr id = "backedge">
            <td>Backedge</td>
          </tr>

          <tr id = "multimap"> 
            <td>Multimap</td>
            <td id = "multimap_t" colspan="20" style="text-align: left">(1,2) <span style="color:red">123</span></td>
          </tr>
        </table>
      </div>
    </div>

    <div class = "canvas"> 
       <canvas id = "draw"></canvas>
    </div>
  </div>

  
</body>

<script src="../../../lib/drawing.js"></script>
<script src="../../../lib/memory_generator.js"></script>
<script src="../dlist/dlist.js"></script>
<script src="dijkstra.js"></script>
<script src="../../../lib/canvas_helper.js"></script>
<script type="text/javascript">



function dijkstra_example(ani) {
  let g = new Graph(ani, "undirect");

  g.get_nodes([2, 0, 11, 1, 9, 8, 4, 5, 10, 3, 7 , 6]);
  g.get_edges_by_name([[0,2,1],  [11,0,7], [1,11,40], [11,4,2],
                       [2,9,12], [8,9,2],  [9,3,8],   [4,8,1],
                       [8,10,1], [3,8,33], [8,6,3],   [6,4,9],
                       [3,7,20], [7,6,1],  [6,5,1]]);
  // g.draw();
  return g;
}

$(document).ready(function(){
  
  set_canvas(1200, 800, 150, 50);
 
  
  var ani = new Animation();
  var g = dijkstra_example(ani);
  var graph_type;
  a = new dijkstraAnimation(ani); // must be name a
  ani.step_by_step = false;
  ANIMATION_TIME = 100;
  a.run_dijkstra(g.get_node(0), g);

  $("#run").click(function() {
    let id = $("#starting_node").val();
    if (id == "") {
      $("#elaboration_text").text("node id is empty");
    } else if (!g.is_node(id)) {
      $("#elaboration_text").text(id + "doesn't exist");
    } else {
      a.run_dijkstra(g.get_node(id), g);
    }

  })
  $("#add_node").click(function() {
   
    let id;
    if (g == null) {
      graph_type = $("input[name=graph_type]:checked").val();
      console.log(graph_type);
      g = new Graph(ani, graph_type);
      $("input[name=graph_type]").prop("disabled", true);
    }
    id = $("#node_t").val();
    id = id.replace(/\s/g,'');
    if (id == "") {
      $("#elaboration_text").text("node id is empty");
    } else if (g.is_node(id)) {
      $("#elaboration_text").text(id + " exists");
    } else {
      g.get_node(id);
      g.draw();
    }
    $("#node_t").val("");
    $("#node_t").focus();
  })

  $("#remove_node").click(function() {
    let id;
    if (g == null) return;
    
    id = $("#node_t").val();
    id = id.replace(/\s/g,'');
   
    if (id == "") {
      $("#elaboration_text").text("node id is empty");
    } else if (!g.is_node(id)) {
      $("#elaboration_text").text(id + " doesn't exist");
    } else {
      g.remove_node(id);
      g.draw();
    }
    $("#node_t").val("");
    $("#node_t").focus();
   
  })


  $("#remove_edge").click(function() {
    let id1, id2, weight;
    let n1, n2;
    let e;
    let str = $("#edge_t").val();
    str = str.trim();
    str = str.split(/[ ,]+/);

    if (g == null) {
      $("#elaboration_text").text("must create node first");
    } else if (str.length != 2) {
      $("#elaboration_text").text("remove_edge: node_id1 node_id2");
    } else {
      id1 = str[0];
      id2 = str[1];
     
      if (!g.is_node(id1)) {
        $("#elaboration_text").text("node " + id1 + " doesn't exist");
      } else if (!g.is_node(id2)) {
        $("#elaboration_text").text("node " + id2 + " doesn't exist");

      } else {
        n1 = g.get_node(id1);
        n2 = g.get_node(id2);
        
        if (!g.is_edge(n1, n2)) {
          $("#elaboration_text").text("Edge" + n1.id + "->" + n2.id + " doesn't exist");
        } else {
          g.remove_edge(n1, n2);
          g.draw();
        }
      }

      $("#edge_t").val("");
      $("#edge_t").focus();

    }
  })
  $("#add_edge").click(function() {
    let id1, id2, weight;
    let n1, n2;
    let e;
    let str = $("#edge_t").val();
    str = str.trim();
    str = str.split(/[ ,]+/);

    if (g == null) {
      $("#elaboration_text").text("must create node first");
    } else if (str.length != 3) {
      $("#elaboration_text").text("add_edge: node_id1 node_id2 weight");
    } else {
      id1 = str[0];
      id2 = str[1];
      weight = parseFloat(str[2]);
      if (isNaN(weight)) {
        $("#elaboration_text").text("add_edge: weight is not valid");
      } else if (!g.is_node(id1)) {
        $("#elaboration_text").text("node " + id1 + " doesn't exist");
      } else if (!g.is_node(id2)) {
        $("#elaboration_text").text("node " + id2 + " doesn't exist");

      } else {
        n1 = g.get_node(id1);
        n2 = g.get_node(id2);
       
        if (g.is_edge(n1, n2)) {
          e = g.get_edge(n1, n2);
          $("#elaboration_text").text(e.id + " exists");
        } else {
          g.get_edge(n1, n2, weight);
          g.draw();
        }
      }
      $("#edge_t").val("");
      $("#edge_t").focus();

    }
    
  })

  // $("#node").append("<td id = \"node_0\"> new node </td>");
  // $("#node_0").css("background-color","pink");
  // $("#node_0").text("new 1");

});

</script>

<script src="../../../lib/control.js"></script>

</html>