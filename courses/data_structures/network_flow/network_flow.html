<!--
  ChaoHui Zheng
  11/22/2020
-->
<!DOCTYPE html>
<html>
<head>

  <title></title>
  <link rel="stylesheet" href="../../../style/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <style type="text/css">
    input[type = "text"]{
      width: 100px;
    }  
  </style>
  
</head>
<body>
   <div class = "grid-container">
    <div class = "header">Network Flow</div>
    <div class = "control"> 

     
      <input type="text" id="node_t" placeholder="node id"> 
      <button type="button" id = "add_node">Add Node</button> 
      <button type="button" id = "remove_node">Remove Node</button> &emsp;&emsp;

      <input type="text" id="edge_t" placeholder="id1 id2 weight"> 
      <button type="button" id = "add_edge">Add Edge</button>
      <button type="button" id = "remove_edge">Remove Edge</button> &emsp;&emsp;
      
     
      
      <div class = "line"></div>

      <input type="text" id="starting_node" placeholder="starting node"> 
      <button type="button" id = "run">Run</button> &emsp;&emsp;

      <input type="text" id="ending_node" placeholder="ending node"> 
      <button type="button" id = "get_path">Get Path</button> &emsp;&emsp;

      <button type="button" id = "clear_graph">Clear Graph</button> &emsp;&emsp;

      <!-- make the display none and check directed because network flow problem works on directed graph -->
      <div style="display: none">
        <input type="radio" id="undirected" name="graph_type" value = "undirect"> 
        <label for="graph_type">Undirected Graph</label> 
        <input type="radio" id="directed" name="graph_type" value = "direct" checked>
        <label for="graph_type">Directed Graph</label>
      </div>
      <div class = "line"></div>
      
      <div class = "animation-control">
        <button type="button" id = "go_back">Go Back</button>&emsp;
        <button type="button" id = "go_forward">Go Forward</button>&emsp;&emsp;
        Step-by-Step Animation<input type="checkbox" id="step_by_step">&emsp;&emsp;
        Animation Speed&emsp;<input type="range" min="0" max="100" value="50" id="speed"> 
      </div>

      <div class = "elaboration">
        Elaboration: <span id = "elaboration_text" style="color:red"></span> 
        <table border = 1 class = "elaboration-table">
          <tr id = "node">
            <td>Node</td>
          </tr>

          <tr id = "distance">
            <td>Distance</td>
          </tr>

          <tr id = "backedge">
            <td>Backedge</td>
          </tr>

          <tr id = "multimap"> 
            <td>Multimap</td>
          </tr>
        </table>
      </div>
    </div>

    <div class = "canvas"> 
       <canvas id = "draw"></canvas>
    </div>
  </div>

  <!-- This is general import and export doesn't do error check for specific animation to do!!!!! -->
  <!-- <div class = "file-management">
    <button id = "import_graph">Import Graph</button>
    <input type="file" name ="Import Graph" style="display: none" id = "import_input">

    <button id = "download_graph">Download Graph</button>
    <a id = "download" download></a>
  </div> -->

  
</body>

<script src="../../../lib/drawing.js"></script>
<script src="../../../lib/memory_generator.js"></script>
<script src="../dlist/dlist.js"></script>
<script src="network_flow.js"></script>
<script src="../../../lib/canvas_helper.js"></script>
<script type="text/javascript">



function network_flow_example(ani) {
  let g = new Graph(ani, "direct");
  let c;
  
  c = g.get_node("S").ani_circle;
  c.move(-120 - c.x, 120 - c.y);
  c = g.get_node("A").ani_circle;
  c = g.get_node("B").ani_circle;
  c.move(0 - c.x, 120 - c.y);
  c = g.get_node("C").ani_circle;
  c.move(-40 - c.x, 240 - c.y);
  c = g.get_node("T").ani_circle;
  c.move(220 - c.x, 120 - c.y);
  c = g.get_node("D").ani_circle;
  c.move(120 - c.x, 240 - c.y);

  g.get_edges_by_name([["S", "A", 10], ["S", "C", 14], ["A", "B", 5], 
                       ["A", "T", 5],  ["B", "T", 8], ["C","B",13],
                       ["C","D", 10],  ["D", "T", 12]]);
  console.log(g.edge_map)

  return g;
}

$(document).ready(function(){
  


  set_canvas(1200, 800, 250, 50);
  MAIN_G_SPEC.weight_type = T_NON_NEGATIVE_NUMBER;
  MAIN_G_SPEC.enable_node_color_change = false;
  MAIN_G_SPEC.enable_edge_color_change = false;
  MAIN_G_SPEC.graph_type = T_DIRECTED;
  
  MAIN_A = new networkFlowAnimation(); // must be name ani
  MAIN_G = network_flow_example(MAIN_A.ani);
  D_ANIMATION_TIME = 100 - $("#speed").val();
 
  MAIN_G.draw();
  
  // let flow = MAIN_A.find_max_flow(MAIN_G, MAIN_G.get_node("S"), MAIN_G.get_node("T"));
  // console.log(flow)
  $("#get_path").click(function(){
    let id = $("#ending_node").val();
    let g = MAIN_G;
    if (id == "") {
      $("#elaboration_text").text("node id is empty");
    } else if (g == null) {
      // $("#elaboration_text").text("node id is empty");
    } else if (!g.is_node(id)) {
      $("#elaboration_text").text(id + "doesn't exist");
    } else {
      MAIN_A.find_path(g.get_node(id), g);
    }

    
  })

  $("#run").click(function() {
    let id = $("#starting_node").val();
    let g = MAIN_G;
    if (id == "") {
      $("#elaboration_text").text("node id is empty");
    } else if (g == null) {
    } else if (!g.is_node(id)) {
      $("#elaboration_text").text(id + "doesn't exist");
    } else {
      MAIN_A.run_dijkstra(g.get_node(id), g, $("#leave_node").is(":checked"));
    }

  })


});

</script>

<script src="../../../lib/control.js"></script>
<script src="../graph_creator/graph_creator.js"></script>
</html>